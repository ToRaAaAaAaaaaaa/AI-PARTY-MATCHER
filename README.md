# AI政党・候補者マッチング

Claude AIを使用した日本の政党・候補者マッチングアプリケーションです。ユーザーの政治的な考えや重視する政策を入力すると、AIが分析して**最適な政党と候補者を同時に提案**します。

## 主な機能

- ユーザーの政治的な考えをテキストで入力
- Claude AIによる政策志向の分析
- **政党マッチング**: 適合度の高い政党を3つ提案
- **候補者マッチング**: 適合度の高い候補者を3名提案
- 各政党・候補者の推薦理由を詳しく表示

## 前提条件

このプロジェクトを実行するには、以下がインストールされている必要があります：

- **Node.js** (バージョン 18 以上推奨)
- **npm** (Node.jsに同梱されています)

### Node.jsのインストール

**まだインストールしていない場合：**

- [Node.js公式サイト](https://nodejs.org/)からダウンロードしてインストール
- LTS（長期サポート）版を推奨

**インストール確認：**

```bash
node --version
npm --version
```

## セットアップ方法

### 1. 依存パッケージのインストール

```bash
npm install
```

### 2. APIキーの設定

`.env.example` を `.env` にコピーします：

```bash
cp .env.example .env
```

`.env` ファイルを開いて、Anthropic APIキーを設定します：

```env
VITE_ANTHROPIC_API_KEY=sk-ant-xxxxx
```

**APIキーの取得方法：**

- [Anthropic Console](https://console.anthropic.com/)にアクセス
- アカウントを作成またはログイン
- API Keysセクションで新しいAPIキーを作成
- 取得したキーを`.env`ファイルに貼り付け

### 3. アプリケーションの起動

#### 方法1: 簡単起動（推奨）

```bash
npm start
```

バックエンドサーバーとフロントエンド開発サーバーが同時に起動します。

#### 方法2: 個別起動

**ターミナル1（バックエンドサーバー）:**

```bash
npm run server
```

**ターミナル2（フロントエンド開発サーバー）:**

```bash
npm run dev
```

ブラウザで `http://localhost:5174` を開いてアプリケーションにアクセスできます。

## アーキテクチャ

このアプリケーションは、フロントエンドとバックエンドで構成されています：

```
┌─────────────────────────────────────────────────────────────┐
│ フロントエンド (React + Vite) - ポート 5174                 │
│   ユーザー入力 → 結果表示                                   │
└─────────────────────────────────────────────────────────────┘
                          ↕ HTTP API
┌─────────────────────────────────────────────────────────────┐
│ バックエンド (Express) - ポート 3001                        │
│   候補者データ読み込み → プロンプト生成 → Claude API呼び出し │
└─────────────────────────────────────────────────────────────┘
                          ↕ Anthropic API
┌─────────────────────────────────────────────────────────────┐
│ Claude AI (Haiku 3.5)                                       │
│   政策分析 → 政党・候補者マッチング → JSON結果返却          │
└─────────────────────────────────────────────────────────────┘
```

## ファイル構成と役割

```
ai-party-matcher/
├── server.js              # バックエンドサーバー（Express）
│                          # - Claude APIとの通信
│                          # - 候補者データのプロンプト埋め込み
│                          # - 統合マッチングAPI (/api/analyze)
│
├── candidates.js          # 候補者データベース
│                          # - 架空の立候補者5名のデータ
│                          # - ボートマッチ形式の政策回答（5段階評価）
│                          # - 将来的にはボートマッチサイトAPI連携予定
│
├── src/
│   ├── main.jsx           # Reactアプリのエントリーポイント
│   ├── App.jsx            # ルートコンポーネント
│   ├── AIPartyMatcher.jsx # メインUIコンポーネント
│   │                      # - ユーザー入力フォーム
│   │                      # - 政党・候補者マッチング結果表示
│   │                      # - APIとの通信処理
│   ├── index.css          # グローバルスタイル（Tailwind）
│   └── App.css            # アプリ固有のスタイル
│
├── index.html             # HTMLテンプレート
├── package.json           # 依存関係・スクリプト定義
├── vite.config.js         # Vite設定
├── tailwind.config.js     # Tailwind CSS設定
├── postcss.config.js      # PostCSS設定
├── eslint.config.js       # ESLint設定
├── .env                   # 環境変数（APIキー）※gitignore対象
└── .env.example           # 環境変数テンプレート
```

### 主要ファイルの詳細

#### server.js（バックエンド）
- Express サーバー（ポート3001）
- `/api/analyze` エンドポイントで政党・候補者の統合マッチングを実行
- `candidates.js`から候補者データを読み込み、プロンプトに埋め込む
- Claude API（Haiku 3.5）を呼び出し、JSON形式の結果を返却

#### candidates.js（候補者データ）
- 架空の立候補者5名のデータを格納
- 各候補者に15問の政策スタンス（5段階評価＋コメント）
- 政策カテゴリ: 経済・財政、社会・人権、教育、安全保障・外交、環境・エネルギー

#### AIPartyMatcher.jsx（フロントエンド）
- ユーザー入力を受け付けるテキストエリア
- バックエンドAPIを呼び出し、結果をパース
- 政党（紫系）と候補者（緑系）のマッチング結果を並べて表示

## 使用技術

| カテゴリ | 技術 | 役割 |
|----------|------|------|
| フロントエンド | React 19 | UIライブラリ |
| ビルドツール | Vite 7 | 開発サーバー・バンドラー |
| バックエンド | Express 5 | APIサーバー |
| スタイリング | Tailwind CSS 4 | ユーティリティCSS |
| アイコン | Lucide React | UIアイコン |
| AI分析 | Claude API (Haiku 3.5) | 政策分析・マッチング |

## 点数算出の仕組み

このアプリはClaude AIがプロンプトの指示に従って点数を算出します（プロンプトエンジニアリング駆動型）。

### 評価基準（100点満点）

| 観点 | 配点 | 内容 |
|------|------|------|
| 政策方向性の一致 | 50点 | ユーザーの政治的志向との基本方針の一致 |
| 具体的施策の一致 | 30点 | 具体的な政策・公約との合致度 |
| 実績・経歴との整合 | 20点 | 過去の行動・実績との整合性 |

### 処理フロー

```
ユーザー入力
    ↓
バックエンド: 候補者データをプロンプトに埋め込み
    ↓
Claude API: 政党・候補者を評価
    ↓
JSON形式で結果返却（政党Top3 + 候補者Top3）
    ↓
フロントエンド: 結果を画面に表示
```

## セキュリティとプライバシー

### APIキーの管理

- **重要**: `.env`ファイルは`.gitignore`に含まれており、Gitにコミットされません
- APIキーは絶対に公開リポジトリにコミットしないでください
- `.env.example`はコミット可能（実際のキーは含まれていません）

### 安全な使用のために

- バックエンド（Express）がAPIキーを管理し、フロントエンドには公開されません
- APIキーはサーバーサイドでのみ使用されます
- CORS設定により、localhost以外からのアクセスは制限されています

## 将来の拡張計画

- ボートマッチサイトとのAPI連携（実際の候補者データ取得）
- RAG（Retrieval-Augmented Generation）による精度向上
- ユーザーフィードバック機能の追加

## 注意事項

- このアプリケーションの分析結果はAIによる参考情報です
- 候補者データは**デモ用の架空データ**です
- 実際の投票判断には各政党・候補者の公式サイトやマニフェストを確認することをおすすめします

## ビルド

```bash
npm run build
```

ビルドされたファイルは `dist` フォルダに出力されます。
